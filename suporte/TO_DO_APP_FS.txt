
(!!!) CODIFICAR NA BRANCH 'dev' (!!!)

******************************************************
******************** APP FINSCORE ********************
******************************************************

* Feito por F.V.
* Cliente: Assertif
* Início: 24/07/2025

//////////////////////////////////////////////
Controle de Versões
//////////////////////////////////////////////
** Alpha    :  0.x.yy
** Beta     :  1.x.yy
** Estáveis :  2+.x.yy (+codinome: pers. lit.)
* x         : Mudanças significativas
* y         : Pequenos ajustes  
* Letras    : Alterações e ajustes incrementais, junto a yy (a, b, ..., z)
......................................................................................................................

====================================
Links e dicas
====================================
Logo                    : https://turbologo.com/
Emojis                  : https://emojipedia.org/
Cores hex               : https://www.color-hex.com/
Streamlit               : https://docs.streamlit.io/ (documentação)
                          https://share.streamlit.io/ (publish)
Streamlit-option-menu   : https://github.com/victoryhb/streamlit-option-menu
Streamlit deploy: https ://finscore-alpha.streamlit.app/?p=lanc
OpenAI API Keys         : https://platform.openai.com/api-keys
OpenAI Usage            : https://platform.openai.com/usage
Boostrap                : https://getbootstrap.com/docs/5.3/components
......................................................................................................................

====================================
0. SETAR O PROJETO
====================================

=====Novidades=====
* (x) Mockup Projeto.
* (x) Organizar Github e VS Code.
* (x) Instalar pacotes python.
* (x) Versão alpha 0.1:
    - (x) Menus;
    - (x) Gráficos e tabelas;
    - (x) Apresentação André.
---
Até aqui:
[v. 0.1, de 19/08/2025]
---

// Entre o dia 20/08 e 01/09/2025 fiquei tentando codificar o promtp do LangChain para padronizar as saídas do 
Parecer com base nos resultados da IA, utilizando o arquivo ipynb. Decidi voltar para a construção do app e deixar 
isso para o final. 

====================================
1. CONFIGURAÇÃO DE VISUAL
====================================

=====Novidades=====
* (x) Cores.
* (x) Integração dos menus com logos e posicionamento.
* (x) Botões.
* (x) Comportamento do APP.
---
Até aqui:
[v. 0.2, de 02/09/2025]
---

=====Novidades=====
* (x) Logo Assertif em todas as seções/views.
---
Até aqui:
[v. 0.3, de 02/09/2025]
---

=====Novidades=====
* (x) Planilha Excel (local) e Google Docs (web) funcionando.
---
Até aqui:
[v. 0.4, de 02/09/2025]
---

=====Novidades=====
* (x) Após "processamento concluído" automaticamente vai para a seção "Resumo".
---
Até aqui:
[v. 0.5, de 02/09/2025]
---

=====Novidades=====
* (x) Substituição de radio por abas na view/seção 'Novo'.
* (x) Seções André.
    - (x) Readequação da v. 0.5 (views/seções diferentes).
    - (x) Resultados (Abas: Resumo, Tabelas e Gráficos da v. 0.1):
        - (x) Dividido em abas (Resumo, Tabelas e Gráficos);
        - (x) Resumo;
        - (x) Tabelas;
        - (x) Gráficos.

    - (x) Parecer (LangChain/OpenAI).

    - (x) sobre:
        - (x) Dividido em abas (Abas: Metodologia, Glossário e FAQ);
        - (x) Glossário;
        - (x) FAQ;
        - (x) Contato.

* (x) Consistência visual (cores e ícones).
---
Até aqui:
[v. 0.6, de 02/09/2025]
---

=====Novidades=====
* (x) Formatação e alinhamento de textos nas views/abas.
---
Até aqui:
[v. 0.6.01, de 05/09/2025]
---

===============================================
2. ORGANIZAÇÃO E FUNCIONALIDADES
===============================================

---------------------------------
2.1 Estrutura da página
---------------------------------

=====Novidades=====
* (x) Seção Metodologia iniciada.
---
Até aqui:
[v. 0.7, de 06/09/2025]
---

=====Novidades=====
* (x) Criar topbar na parte superior (início, novo, relatórios, usuários etc).
---
Até aqui:
[v. 0.7.10, de 06/09/2025]
---

=====Novidades=====
* (x) Encerrada a formatação da versão estática da topbar.
* (x) Centralização das abas e formatação de textos nas seções/views.
* (x) Renomear as views: 'Novo' para 'Lançamentos', e 'Resultados' para 'Análise'.
---
Até aqui:
[v. 0.7.11, de 06/09/2025]
---

=====Novidades=====
* (x) Guia rápido e Lançamentos/Início (ideia inicial).
---
Até aqui:
[v. 0.7.12, de 07/09/2025]
---

=====Novidades=====
* ( ) Topbar interativa:
    - (x) Criação da página Guia Rápido;
    - (x) Criação da página Início;
    - (x) Ajuste para igualar largura com as margens dos textos.
---
Até aqui:
[v. 0.7.13, de 07/09/2025]
---

=====Ajustes=====
* (x) Troquei 'Início' por 'Página Principal' em topbar (evitar confusão com lancamentos.py).
* (x) Ajuste da largura da topbar para se alinhar ao texto.
* (x) Diversos (8 horas nisso!!) conflitos entra sidebar e topbar.
=====Novidades=====
* (x) Remover opção de fechar barra lateral [v. 0.7.13a, de 07/09/2025].
---
Até aqui:
[v. 0.7.14, de 08/09/2025]
---

---------------------------------
2.2 Funcionalidades
---------------------------------

=====Ajustes=====
* (x) Resolvendo de vez conflitos entre topbar e sidebar:
    - (x) state_manager.py, config.py;
    - (x) Atualização app.py, nav.py e topbar.py;
    - (x) Testes.
---
Até aqui:
[v. 0.7.15, de 08/09/2025]
---

=====Ajustes=====
* (x) Clicar em 'Sobre' após calcular o FinScore precisa de clique duplo.
* ( ) Diminuir 1cm de cada lado as margens dos textos [Não funcionou - decidi manter como está].
* (x) Separado o css de app.py (styles/main.css).
---
Até aqui:
[v. 0.7.15a, de 08/09/2025]
---

=====Novidades=====
* (x) Remover "View fullscreen" da barra lateral.
* (x) Inserir ícones (ainda não interativos) nos títulos das abas de Lançamentos.
---
Até aqui:
[v. 0.7.16, de 10/09/2025]
---

=====Novidades=====
* ( ) Textos seções:
    - (x) Guia Rápido (topbar);
    - (x) Sobre/Metodologia (sidebar/nav);
    - (x) Sobre/Glossário (sidebar/nav);
    - (x) Sobre/FAQ (sidebar/nav).
* (x) Criar na sidebar/nav a seção/view 'Novo' em substituição à seção/view 'Home'.
---
Até aqui:
[v. 0.7.17, de 10/09/2025]
---

=====Ajustes=====
* (x) Novo só funcionando após clicar em outro link da sidebar.
=====Novidades=====
* (x) Dropdown Menu "Processo", colapsando "Novo", "Lançamentos", "Análise" e "Parecer" (sidebar/nav).
* (x) Botões de redes sociais, configurações e tema claro/escuro (topbar).
---
Até aqui:
[v. 0.7.18, de 12/09/2025]
---

=====Novidades=====
* (x) Texto da seção/view 'Novo' Reformulada (sidebar/nav).
* (x) Criado botão 'iniciar' em 'Novo' (sidebar/nav).
* (x) Removida a aba 'Início', da seção/view 'Lançamentos' (sidebar/nav).
* (x) Renomeadas as seções e os apontamentos (para as views) 'Definir1' e 'Definir2' para 'Estoque' e 'Cadastros', 
respectivamente (topbar).
* (x) Reescrita da seção/view 'Guia Rápido' (topbar).
* (x) Em negrito a renderização das seções Processo, Sobre e Contato (sidebar/nav).
* (x) Fontes e cor das seções da sidebar/nav reformuladas para combinar com a topbar e o logo do FinScore.
---
Até aqui:
[v. 0.7.19, de 13/09/2025]
---

=====Ajustes=====
* (x) Subi a sidebar/nav para ficar mais próxima da topbar.
* (x) Mudança da cor dos botões para #5ea68d.
---
Até aqui:
[v. 0.7.19a, de 13/09/2025]
---

---------------------------------
2.3 Aperfeiçoamentos
---------------------------------

=====Novidades=====
* (x) Seção Lançamentos só fica clicável/destravado após o usuário clicar no botão 'Iniciar' da seção Novo.
* (x) Seções Análise e Parecer só ficam clicáveis/destravadas após o usuário clicar no botão 'Calcular FinScore'
da seção Lançamentos.
---
Até aqui:
[v. 0.7.20, de 13/09/2025]
---

=====Ajustes=====
* (x) Reescrita de Lançamentos/Início.
---
Até aqui:
[v. 0.7.20a, de 13/09/2025]

=====Ajustes=====
* (x) Reescrita de Lançamentos/Início.
---
Até aqui:
[v. 0.7.20b, de 13/09/2025]
---

=====Novidades=====
* (x) Arquivo README.md
* (x) Arquivo LICENSE.md
---
Até aqui:
[v. 0.7.20c, de 13/09/2025]

=====Ajustes=====
* (x) Pasta 'suporte', englobando os arquivos de notas e controle (TO_DO_APP.txt etc).
---
Até aqui:
[v. 0.7.20d, de 13/09/2025]
---

=====Novidades=====
* (x) Reescrita da seção 'Sobre':
    - (x) Metodologia;
    - (x) Glossário;
    - (x) FAQ. 
---
Até aqui:
[v. 0.7.21, de 13/09/2025]
---

---------------------------------
2.4 Aperfeiçoamentos II
---------------------------------

=====Novidades=====
* (x) Links vinculados aos botões de redes sociais:
    - (x) Facebook;
    - (x) Youtube;
    - (x) Linkedin. 
---
Até aqui:
[v. 0.7.22, de 13/09/2025]
---

=====Novidades=====
* (x) Formulário 'Lançamentos/Cliente':
    - (x) Máscara travando campo 'CNPJ' (formato string), permitindo digitar, colar e corrigir colagens com
    caracteres a mais ou a menos, desde que mantenha a quantidade correta de dígitos.
    - (x) Campo 'Ano Inicial' computado ocmo "YYYY".
    - (x) Campo 'Ano Final' computado como "YYYY".
    - (x) Campo 'Ano Final' computado como ('Ano Inicial'+2).
    - (x) Campo 'Serasa Score' computado como "float".
    - (x) Campo 'Data de Consulta ao Serasa' computado como 'DD/MM/YYYY', permitindo digitar, colar e corrigir.
    colagens com caracteres a mais ou a menos, desde que mantenha a quantidade correta de dígitos.
---
Até aqui:
[v. 0.7.23, de 13/09/2025]
[v. 0.7.23a, de 13/09/2025] (roadmap FORMULÁRIO)
[v. 0.7.23b, de 13/09/2025] (config codespaces linux)
---
 
=====Novidades=====
* (x) Seção Sobre/FAQ em formato accordion;
=====Ajustes=====
* (x) Consistência visual temas claro ou escuro dos sistemas operacionais ou navegadores.
---
Até aqui:
[v. 0.7.24, de 14/09/2025]
---

=====Novidades=====
* (x) Seção Sobre/Glossárionavegável em ordem alfabética (A–Z).
---
Até aqui:
[v. 0.7.25, de 14/09/2025]
---

---------------------------------
2.5 Preparação próximas etapas
---------------------------------

=====Ajustes=====
* (x) Consistência visual temas claro ou escuro dos sistemas operacionais ou navegadores com falhas (ainda) em 
Sobre/Metodologia e Sobre/FAQ.
* (x) Removi a opção de download da tabela em Sobre/Metodologia.
* (x) Reorganização e melhoria do texto de Sobre/Metodologia.
* (x) Revisado st.header como padrão para os títulos
---
Até aqui:
[v. 0.7.25a, de 14/09/2025]
---

=====Ajustes=====
* (x) Aviso de versão e preferência por tema claro em Home (após tentar consertar inconsistêncis em lancamentos.py).
---
Até aqui:
[v. 0.7.25b, de 14/09/2025]
---

=====Ajustes=====
* (x) Aumento dos termos do glossário
---
Até aqui:
[v. 0.7.25c, de 14/09/2025]
[v. 0.7.25d, de 14/09/2025] (testes 0.7.26, mas não funcionando as novas funções)
---

 =====Novidades=====
* ( ) Após clicar no botão 'Calcular FinScore', se não prosseguir nas seções 'Análise' e 'Parecer'. ao tentar 
clicar em outra seção (exceto 'Sobre'), um popup avisa que os dados serão perdidos e dá a opção de prosseguir 
com o cálculo ou perdê-los. (DESISTI)
- Desistência, pois os elementos HTML que decoram a navbar impedem o popup de funcionar. A solução seria usar 
objetos Streamlit nativos, mas a estética seria comprometida. Procurar outra solução quando fizer o backend.
---
Até aqui:
[v. 0.7.25e, de 14/09/2025]
---

=====Ajustes=====
* (x) Limpeza do código com as regras de v. 0.7.25e
* (x) Obrigatoriedade de todos os campos de Novo/Cliente estarem preenchidos para que o cálculo de FinScore
prossiga.
* (x) Formatação de fontes em Análise/Resumo.
---
Até aqui:
[v. 0.7.26, de 14/09/2025]
---

=====Ajustes=====
* (x) Sumir com os ícones de link que aparecem quando o ponteiro do mouse repousa sobre certas áreas, como títulos.
- Código testado em todas as seções. Estética e funcionalidades aparentemente funcionando.
- Versão base antes da implementação do LangChain.
---
Até aqui:
[v. 0.7.26a, de 14/09/2025]
---

=====Ajustes=====
* (x) Organização (Roadmap) da parte 3 (PARECER) deste to do.
---
Até aqui:
[v. 0.7.26b, de 14/09/2025]
[v. 0.7.26d, de 16/09/2025]
---

=====Ajustes=====
* (x) Correção de racional em utils_finscore.py - peso maior estava indo para mais antigo.
---
Até aqui:
[v. 0.7.26c, de 15/09/2025]
---
......................................................................................................................

============
3. ANÁLISE
============

---------------------------------
3.1 PRELIMINARES
---------------------------------

=====Novidades=====
* (x) Anos (2021, 2022 e 2023) substituírem ordem cardinal (0, 1 e 2):
    - (x) Planilhas (Excel e Google Sheets);
    - (x) Adaptar anos em Análise/Gráficos e Análise/Tabelas;
* (x) Ordem de apresentação dos anos ajustada nos gráficos.
=====Ajustes=====
* (x) Ordem de apresentação dos anos nas linhas da planilha com dados contábeis (mais antigo na primeira linha).
* (x) Nomenclatura da coluna 'Ano' na planilha alterada de [0, 1, 2] para [1, 2, 3], sendo 1 o mais antigo.
---
Até aqui:
[v. 0.7.27 (dev), de 19/09/2025]
---

=====deploy=====
* (x) Colocar no ar em Streamlit a versão mais recente de dev:
    - (x) Git merge.
---
Até aqui:
[v. 0.7.27a (main), de 20/09/2025]
---

=====Novidades=====
* (x) Novos gráficos:
    - (x) Criar Classificação;
    - (x) Organizar aba conforme Classificação feita.
* (x) Novas tabelas:
    - (x) Criar Classificação.
---
Até aqui:
[v. 0.7.28 (dev), de 20/09/2025]
---

=====Novidades=====
* (x) Novos gráficos
    - (x) Estudar quais;
    - (x) Codificar.
* (x) Novas tabelas
    - (x) Estudar quais;
    - (x) Codificar.
---
Até aqui:
[v. 0.7.29 (dev), de 20/09/2025]
---

=====Ajustes=====
* (x) Formatar gráficos.
* (x) Formatar tabelas.
* (x) Campos 'Data da Análise' e 'Data de Consulta ao Serasa' em /Análise/Resumo.
* (x) Em /Análise, renomeei a aba 'Graficos' para 'Gráficos'.
---
Até aqui:
[v. 0.7.29a (dev), de 20/09/2025]
[v. 0.7.29c (dev), de 20/09/2025] - ajustes pós merge
---

=====deploy=====
* (x) Colocar no ar em Streamlit a versão mais recente de dev
    - (x) Git merge
---
Até aqui:
[v. 0.7.29b (main), de 20/09/2025]
---

---------------------------------
3.2 IA (preparação Parecer)
---------------------------------

=====Ajustes=====
* (x) Configurar Langchain:
    * (x) Importar bibliotecas (definir quais e momento);
    * (x) Credenciais OpenAI.
* (x) Estudar onde o prompt será inserido no projeto.
* (x) Testar prompts aleatórios (resultados finscore, gráficos ou tabelas).
* (x) Definir layout de onde serão inseridos os marcadores/caixinhas que apresentarão.
os resultados dos prompts na seção /Análise.
---
Até aqui:
[v. 0.8.01 (ia), de 23/09/2025]
---

=====Novidades=====
* (x) Dados Análise/Resumo:
    - (x) FinScore Bruto:
        + (x) Número;
        + (x) Classificação:
            . (x) IA/LLM (prompt IA + edição humana + retorno IA final).
    - (x) FinScore Ajustado:
        + (x) Número;
        + (x) Classificação:
            . (x) IA/LLM (prompt IA + edição humana + retorno IA final).
    - (x) Serasa Score:
        + (x) Número;
        + (x) Classificação:
            . (x) IA/LLM (prompt IA + edição humana + retorno IA final).
* (x) Gráficos de Análise/Gráficos:
    - (x) Dados Contábeis brutos:
        + (x) Definir gráficos:
            . (x) IA/LLM (prompt IA + edição humana + retorno IA final).
    - (x) Índices Contábeis:
        + (x) Definir gráficos:.
            . (x) IA/LLM (prompt IA + edição humana + retorno IA final)
* (x) Tabelas de Análise/Tabelas:
    - (x) Dados Contábeis brutos:
        + (x) Definir tabelas:
            . (x) IA/LLM (prompt IA + edição humana + retorno IA final).
    - (x) Índices Contábeis:
        + (x) Definir tabelas:
            . (x) IA/LLM (prompt IA + edição humana + retorno IA final).
    - (x) Componentes Principais (PCA):
        + (x) IA/LLM (prompt IA, sem interação humana).
    - (x) Top 3 Índices por Componente:
        + (x) IA/LLM (prompt IA, sem interação humana).
---
Até aqui:
[v. 0.8.02 (ia), de 23/09/2025]
---

=====Novidades=====
* ( ) Salvar cache dados exceto se clicar em /Novo.
=====Ajustes=====
* (x) Testes [v. 0.8.01 (ia)].
* (x) Testes [v. 0.8.02 (ia)].
---
Até aqui:
[v. 0.8.03 (ia), de 24/09/2025]
[v. 0.8.03a (ia), de 24/09/2025]
[v. 0.8.03b (ia), de 24/09/2025]
[v. 0.8.03c (ia), de 27/09/2025] --> cache em nav e topbar funcionando
[v. 0.8.04 (ia), de 27/09/2025] --> cache em nav e topbar funcionando, visual e formato dos nrs ok.
---

=====Ajustes=====
* (x) Diminuição da largura da sidebar, ajustes em cores e nova logo
---
Até aqui:
[v. 0.8.05 (ia), de 27/09/2025]
---

=====Novidades=====
* ( ) LLM /Análise
    * (x) Reconfiguração de 'Gerar crítica da IA' para 'Insight', em popover
    * ( ) Processamento IA em segundo plano não termina
    * ( ) Resultados botão análise IA
    * ( ) Processamento IA em segundo plano
    * ( ) Setas cima, baixo, direita-esquerda
* ( ) Aba Resumo
---
Até aqui:
[v. 0.8.06 (ia), de 28/09/2025]
[v. 0.8.06a (ia), de 28/09/2025] - 'Processando' em análise sem funcionar
Desistência da ideia de processamento em segundo plano. O Streamlit não permite.
---

=====Ajustes=====
* (x) Readequação do prompt para o LLM com a exclusão das análises parciais e /Análise
=====Novidades=====
* (x) Versão alpha do parecer implementada
---
Até aqui:
[v. 0.8.07 (ia), de 03/10/2025]
---

=====Ajustes=====
* (x) Correção de ortografia
---
Até aqui:
[v. 0.8.08 (ia), de 03/10/2025]
---


......................................................................................................................
============
4. PARECER
============
* ( ) Definir e configurar dados que servirão de parâmetro.
* ( ) Configurar modelo padrão.
* ( ) Testar diferentes resultados/cenários.

......................................................................................................................
============
5. LOGIN
============
* ( ) Estudar bibliotecas
* ( ) Codificar

......................................................................................................................
============
Ideias
============
- Campos 'Dados do Cliente' com crítica de valores
- No dropdown da sidebar, inserir o menu/view 'Consultar', mas só depois de criar o backend com do banco de dados
- Para burlar o desbloqueio dos campos em Processo, basta saber os links dos submenus. Mascarar barra de endereços ou
alguma outra solução para dar mais segurança.

MELHORIAS PONTUAIS
- Criar conteúdo da seção Contato (ex.: https://macmagazine.com.br/contato/). Definir com Assertif para onde 
isso apontará, se for necessária mesmo.
- Clique de 'voltar ao topo' em Sobre/Glossário mostrar a topbar.
- Forçar tema claro na versão 1.x.yy (Beta)

BACKEND
- API REST para integração externa
- Dashboard administrativo
- Relatórios em PDF
- Integração com mais fontes de dados
- Machine Learning para previsões
- Sistema de usuários e permissões
......................................................................................................................

